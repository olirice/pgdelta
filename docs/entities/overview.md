# Supported Entities Overview

This page provides a comprehensive overview of PostgreSQL entities supported by pgdelta, organized by operation type.

## Support Status Legend

- ‚úÖ **Supported**: Full implementation with comprehensive test coverage
- ‚ùå **Not Supported**: Not yet implemented, may be planned for future release
- üö´ **Not Applicable**: Operation doesn't apply to this entity type
- üîÑ **Partial**: Limited implementation, see entity details below

## Entity Support Matrix

| Entity | CREATE | DROP | ALTER | REPLACE | Notes |
|--------|--------|------|-------|---------|-------|
| [Schemas](#schemas) | ‚úÖ | ‚úÖ | ‚ùå | üö´ | Basic schema lifecycle |
| [Tables](#tables) | ‚úÖ | ‚úÖ | ‚úÖ | üö´ | Full table support with columns |
| [Constraints](#constraints) | ‚úÖ | ‚úÖ | üîÑ | üö´ | All constraint types |
| [Indexes](#indexes) | ‚úÖ | ‚úÖ | ‚ùå | üö´ | All index types and methods |
| [Views](#views) | ‚úÖ | ‚úÖ | ‚ùå | ‚úÖ | Basic view support |
| [Materialized Views](#materialized-views) | ‚úÖ | ‚úÖ | ‚ùå | ‚úÖ | Created with NO DATA |
| [Functions](#functions) | ‚úÖ | ‚úÖ | ‚ùå | ‚úÖ | All function types via pg_get_functiondef |
| [Triggers](#triggers) | ‚úÖ | ‚úÖ | ‚ùå | ‚úÖ | All trigger types via pg_get_triggerdef |
| [Sequences](#sequences) | ‚úÖ | ‚úÖ | üîÑ | üö´ | Basic sequence support |
| [Types](#types) | ‚úÖ | ‚úÖ | ‚ùå | üö´ | Enum and composite types |
| [Policies](#policies) | ‚úÖ | ‚úÖ | ‚úÖ | üö´ | Row Level Security policies |

---

## Schemas

**PostgreSQL Reference**: [CREATE SCHEMA](https://www.postgresql.org/docs/17/sql-createschema.html) | [DROP SCHEMA](https://www.postgresql.org/docs/17/sql-dropschema.html)

### CREATE SCHEMA

```sql
CREATE SCHEMA [ IF NOT EXISTS ] schema_name [ AUTHORIZATION role_specification ] [ schema_element [ ... ] ]
```

#### ‚úÖ Currently Supported
- Basic schema creation with schema name

#### ‚ùå Not Yet Supported
- IF NOT EXISTS option
- AUTHORIZATION clause
- Schema elements (CREATE TABLE, CREATE VIEW, etc. in schema definition)

#### üö´ Intentionally Not Supported
- None currently

### DROP SCHEMA

```sql
DROP SCHEMA [ IF EXISTS ] name [, ...] [ CASCADE | RESTRICT ]
```

#### ‚úÖ Currently Supported
- Basic schema deletion
- Dependency-aware ordering (contents dropped first)

#### üö´ Intentionally Not Supported
- IF EXISTS (pgdelta tracks existence)
- CASCADE/RESTRICT (handled by dependency resolution)

---

## Tables

**PostgreSQL Reference**: [CREATE TABLE](https://www.postgresql.org/docs/17/sql-createtable.html) | [DROP TABLE](https://www.postgresql.org/docs/17/sql-droptable.html) | [ALTER TABLE](https://www.postgresql.org/docs/17/sql-altertable.html)

### CREATE TABLE

```sql
CREATE [ [ GLOBAL | LOCAL ] { TEMPORARY | TEMP } | UNLOGGED ] TABLE [ IF NOT EXISTS ] table_name ( [
  { column_name data_type [ column_constraint [ ... ] ] | table_constraint } [, ... ]
] )
[ INHERITS ( parent_table [, ... ] ) ]
[ WITH ( storage_parameter [= value] [, ... ] ) ]
```

#### ‚úÖ Currently Supported
- Basic table creation with columns
- Column data types with precision/scale
- NOT NULL constraints
- DEFAULT expressions
- Generated columns (GENERATED ALWAYS AS)
- Table inheritance (INHERITS clause)
- Storage parameters (WITH clause)

#### ‚ùå Not Yet Supported
- Column STORAGE settings (PLAIN, EXTERNAL, EXTENDED, MAIN)
- Column COMPRESSION settings
- Column COLLATE settings
- PARTITION BY clause (RANGE, LIST, HASH partitioning)
- USING method for access method
- TABLESPACE clause
- Identity columns (GENERATED BY DEFAULT AS IDENTITY)

#### üö´ Intentionally Not Supported
- TEMPORARY/TEMP tables (not persistent schema objects)
- UNLOGGED tables (storage detail that changes automatically)
- IF NOT EXISTS (pgdelta tracks existence)
- WITHOUT OIDS (deprecated PostgreSQL feature)

### ALTER TABLE

#### ‚úÖ Currently Supported
- ADD COLUMN (with NOT NULL, DEFAULT)
- DROP COLUMN
- ALTER COLUMN TYPE (with USING expression)
- ALTER COLUMN SET/DROP DEFAULT
- ALTER COLUMN SET/DROP NOT NULL

#### ‚ùå Not Yet Supported
- Table/column renaming
- Schema changes (SET SCHEMA)
- Storage parameter modifications
- Identity column operations
- Column statistics modifications

#### üö´ Intentionally Not Supported
- RENAME TO (uses drop/recreate pattern)
- IF EXISTS (pgdelta tracks existence)

---

## Constraints

**PostgreSQL Reference**: [ALTER TABLE (constraints)](https://www.postgresql.org/docs/17/sql-altertable.html)

### CREATE CONSTRAINT

```sql
ALTER TABLE table_name ADD CONSTRAINT constraint_name {
  PRIMARY KEY (column_list) |
  UNIQUE (column_list) |
  CHECK (expression) |
  FOREIGN KEY (column_list) REFERENCES table (column_list) [actions] |
  EXCLUDE [USING method] (expression WITH operator [, ...]) [WHERE predicate]
}
```

#### ‚úÖ Currently Supported
- PRIMARY KEY constraints
- UNIQUE constraints
- CHECK constraints
- FOREIGN KEY constraints
- EXCLUSION constraints
- Constraint deferrability options
- Foreign key actions (CASCADE, RESTRICT, SET NULL, SET DEFAULT, NO ACTION)

#### ‚ùå Not Yet Supported
- Constraint inheritance
- Domain constraints
- Partial unique constraints with WHERE clause

#### üö´ Intentionally Not Supported
- NOT VALID option (pgdelta assumes constraints should be valid)

### ALTER CONSTRAINT

#### üîÑ Partial Support
- Basic constraint modifications (limited)

#### ‚ùå Not Yet Supported
- Constraint deferrability changes
- Constraint validation operations

---

## Indexes

**PostgreSQL Reference**: [CREATE INDEX](https://www.postgresql.org/docs/17/sql-createindex.html) | [DROP INDEX](https://www.postgresql.org/docs/17/sql-dropindex.html)

### CREATE INDEX

```sql
CREATE [ UNIQUE ] INDEX [ CONCURRENTLY ] [ name ]
ON table_name [ USING method ]
( { column_name | ( expression ) } [ opclass ] [ ASC | DESC ] [ NULLS { FIRST | LAST } ] [, ...] )
[ INCLUDE ( column_name [, ...] ) ]
[ WITH ( storage_parameter = value [, ...] ) ]
[ WHERE predicate ]
```

#### ‚úÖ Currently Supported
- Regular and unique indexes
- Partial indexes with WHERE clause
- Functional indexes with expressions
- All standard index methods (btree, hash, gin, gist, spgist, brin)
- Custom operator classes
- Collation specifications
- ASC/DESC ordering options
- NULLS FIRST/LAST options
- Multi-column indexes
- Storage parameters (WITH clause)

#### ‚ùå Not Yet Supported
- INCLUDE columns (covering indexes)
- NULLS [NOT] DISTINCT option
- ONLY modifier for inheritance
- TABLESPACE clause
- Operator class parameters

#### üö´ Intentionally Not Supported
- CONCURRENTLY option (not needed for schema migration)
- IF NOT EXISTS (pgdelta tracks existence)

---

## Views

**PostgreSQL Reference**: [CREATE VIEW](https://www.postgresql.org/docs/17/sql-createview.html) | [DROP VIEW](https://www.postgresql.org/docs/17/sql-dropview.html)

### CREATE VIEW

```sql
CREATE [ OR REPLACE ] [ TEMP | TEMPORARY ] [ RECURSIVE ] VIEW name [ ( column_name [, ...] ) ]
[ WITH ( view_option [, ...] ) ]
AS query
[ WITH [ CASCADED | LOCAL ] CHECK OPTION ]
```

#### ‚úÖ Currently Supported
- Basic view creation with schema-qualified names
- View definition (AS query)
- CREATE OR REPLACE VIEW

#### ‚ùå Not Yet Supported
- RECURSIVE views
- Explicit column names
- View options (WITH clause)
- CHECK OPTION (WITH CHECK OPTION)

#### üö´ Intentionally Not Supported
- TEMPORARY views (not persistent schema objects)

---

## Materialized Views

**PostgreSQL Reference**: [CREATE MATERIALIZED VIEW](https://www.postgresql.org/docs/17/sql-creatematerializedview.html)

### CREATE MATERIALIZED VIEW

```sql
CREATE MATERIALIZED VIEW [ IF NOT EXISTS ] table_name
[ (column_name [, ...]) ]
[ WITH ( storage_parameter [= value] [, ...] ) ]
AS query
[ WITH [ NO ] DATA ]
```

#### ‚úÖ Currently Supported
- Basic materialized view creation
- All SELECT query features via pg_get_viewdef
- Complex queries with JOINs, CTEs, etc.

#### ‚ùå Not Yet Supported
- Storage parameters (WITH clause)
- USING method specification
- Explicit column names

#### üö´ Intentionally Not Supported
- WITH DATA option (always uses NO DATA for safety)
- TABLESPACE specification
- IF NOT EXISTS (pgdelta tracks existence)

---

## Functions

**PostgreSQL Reference**: [CREATE FUNCTION](https://www.postgresql.org/docs/17/sql-createfunction.html) | [DROP FUNCTION](https://www.postgresql.org/docs/17/sql-dropfunction.html)

### CREATE FUNCTION

```sql
CREATE [ OR REPLACE ] FUNCTION name ( [ arguments ] )
{ RETURNS rettype | RETURNS TABLE ( columns ) }
{ LANGUAGE lang_name | AS 'definition' | ... }
```

#### ‚úÖ Currently Supported (via pg_get_functiondef)
- All argument modes (IN, OUT, INOUT, VARIADIC)
- Argument names and default values
- All return types including RETURNS TABLE
- All languages (SQL, PL/pgSQL, C, etc.)
- All function attributes (IMMUTABLE, STABLE, VOLATILE, etc.)
- Security context (SECURITY DEFINER/INVOKER)
- Cost and row estimates
- Configuration parameter settings
- All PostgreSQL function features

#### ‚ùå Not Yet Supported
- None (complete support via pg_get_functiondef)

#### üö´ Intentionally Not Supported
- None (all features valid for DDL generation)

---

## Triggers

**PostgreSQL Reference**: [CREATE TRIGGER](https://www.postgresql.org/docs/17/sql-createtrigger.html) | [DROP TRIGGER](https://www.postgresql.org/docs/17/sql-droptrigger.html)

### CREATE TRIGGER

```sql
CREATE [ OR REPLACE ] [ CONSTRAINT ] TRIGGER name
{ BEFORE | AFTER | INSTEAD OF } { event [ OR ... ] }
ON table_name
[ FOR [ EACH ] { ROW | STATEMENT } ]
[ WHEN ( condition ) ]
EXECUTE { FUNCTION | PROCEDURE } function_name ( arguments )
```

#### ‚úÖ Currently Supported (via pg_get_triggerdef)
- All timing options (BEFORE, AFTER, INSTEAD OF)
- All event types (INSERT, UPDATE, DELETE, TRUNCATE)
- Column-specific UPDATE triggers
- Row-level and statement-level triggers
- WHEN conditions for conditional execution
- Constraint triggers with deferral options
- Transition relations (OLD/NEW TABLE AS)
- All trigger function calling conventions

#### ‚ùå Not Yet Supported
- None (complete support via pg_get_triggerdef)

#### üö´ Intentionally Not Supported
- ENABLE/DISABLE TRIGGER (runtime operation, not DDL)

---

## Sequences

**PostgreSQL Reference**: [CREATE SEQUENCE](https://www.postgresql.org/docs/17/sql-createsequence.html) | [DROP SEQUENCE](https://www.postgresql.org/docs/17/sql-dropsequence.html)

### CREATE SEQUENCE

```sql
CREATE SEQUENCE [ IF NOT EXISTS ] name
[ AS data_type ]
[ INCREMENT [ BY ] increment ]
[ MINVALUE minvalue | NO MINVALUE ]
[ MAXVALUE maxvalue | NO MAXVALUE ]
[ START [ WITH ] start ]
[ CACHE cache ]
[ [ NO ] CYCLE ]
[ OWNED BY { table_name.column_name | NONE } ]
```

#### ‚úÖ Currently Supported
- Basic sequence creation with name
- Data type specification (smallint, integer, bigint)
- INCREMENT BY values
- MINVALUE/MAXVALUE bounds
- START WITH initial value
- CACHE settings
- CYCLE/NO CYCLE behavior
- OWNED BY table column associations

#### ‚ùå Not Yet Supported
- None (all standard sequence parameters are supported)

#### üö´ Intentionally Not Supported
- TEMPORARY/TEMP sequences (not persistent schema objects)
- UNLOGGED sequences (storage detail)
- IF NOT EXISTS (pgdelta tracks existence)

### ALTER SEQUENCE

#### üîÑ Partial Support
- OWNED BY operations

#### ‚ùå Not Yet Supported
- Parameter modifications (INCREMENT, MINVALUE, etc.)
- RESTART operations

---

## Types

**PostgreSQL Reference**: [CREATE TYPE](https://www.postgresql.org/docs/17/sql-createtype.html) | [DROP TYPE](https://www.postgresql.org/docs/17/sql-droptype.html)

### CREATE TYPE

```sql
-- Composite type
CREATE TYPE name AS (
    attribute_name data_type [, ...]
);

-- Enum type
CREATE TYPE name AS ENUM (
    'label' [, ...]
);

-- Range type
CREATE TYPE name AS RANGE (
    SUBTYPE = subtype [, ...]
);
```

#### ‚úÖ Currently Supported
- Composite types with attribute definitions
- Enum types with label specifications
- Basic type dependency tracking

#### ‚ùå Not Yet Supported
- Domain types
- Range types
- Multirange types
- Base types (require C code)
- Shell types

#### üö´ Intentionally Not Supported
- None currently

---

## Policies

**PostgreSQL Reference**: [CREATE POLICY](https://www.postgresql.org/docs/17/sql-createpolicy.html) | [DROP POLICY](https://www.postgresql.org/docs/17/sql-droppolicy.html)

### CREATE POLICY

```sql
CREATE POLICY name ON table_name
[ AS { PERMISSIVE | RESTRICTIVE } ]
[ FOR { ALL | SELECT | INSERT | UPDATE | DELETE } ]
[ TO { role_name | PUBLIC | CURRENT_ROLE | CURRENT_USER | SESSION_USER } [, ...] ]
[ USING ( using_expression ) ]
[ WITH CHECK ( check_expression ) ]
```

#### ‚úÖ Currently Supported
- Basic policy creation with name and table
- Command-specific policies (FOR clause)
- Role-based policies (TO clause)
- Row filtering with USING expressions
- New row validation with WITH CHECK expressions

#### ‚ùå Not Yet Supported
- PERMISSIVE/RESTRICTIVE policy types
- Multiple role specifications

#### üö´ Intentionally Not Supported
- None (all features valid for DDL generation)

### ALTER POLICY

#### ‚úÖ Currently Supported
- Policy modifications
- Expression changes
- Role assignments

---

## Intentionally Not Supported

### Environment-Specific Features
- **Extensions**: Database-specific, require installation on target database
- **Tablespaces**: File system layout, environment-specific
- **Roles and Users**: Instance-level, not database-level objects
- **Privileges (GRANT/REVOKE)**: Security context that varies by environment
- **Configuration parameters**: Runtime settings, not schema

### Runtime Objects
- **Temporary tables/views**: Not persistent schema objects
- **Statistics**: Runtime-generated metadata
- **Locks**: Runtime state, not schema

### Operational Features
- **CONCURRENTLY options**: Not needed for schema migration
- **IF [NOT] EXISTS**: pgdelta tracks existence
- **Comments**: Not needed for functional schema recreation

---

## PostgreSQL Version Support

pgdelta is developed and tested against PostgreSQL 17, with support for:
- **PostgreSQL 17**: Full feature support
- **PostgreSQL 16**: Full feature support
- **PostgreSQL 15**: Core feature support
- **PostgreSQL 14**: Core feature support
- **PostgreSQL 13**: Core feature support

## Future Enhancements

### Planned Features
- **ALTER operations**: Enhanced alter support for constraints and indexes
- **Domain types**: Domain type support with constraints
- **Partitioning**: Table partitioning support
- **Advanced materialized views**: WITH DATA options, storage parameters

### Not Planned
- **Extensions**: Environment-specific, not portable
- **Comments**: Not needed for functional schema recreation
- **Privileges**: Environment-specific security context
- **Tablespaces**: File system layout considerations

## Contributing

To contribute support for new entity features:
1. Review the [Contributing Guide](../contributing/setup.md)
2. Follow the [Adding New Entities](../contributing/adding-entities.md) guide
3. Ensure comprehensive test coverage with real PostgreSQL
4. Maintain roundtrip fidelity

The project prioritizes correctness and completeness over speed of implementation.